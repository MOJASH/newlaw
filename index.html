<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حاسبة الحقوق العمالية - قانون العمل الأردني</title>
    <style>
        :root {
            --primary-color: #2c5aa0;
            --secondary-color: #f8f9fa;
            --accent-color: #e63946;
            --text-color: #333;
            --border-color: #ddd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            border-radius: 8px 8px 0 0;
            text-align: center;
            position: relative;
        }
        
        .creator-info {
            position: absolute;
            left: 15px;
            top: 10px;
            font-size: 10px;
            opacity: 0.7;
        }
        
        h1 {
            margin-bottom: 5px;
        }
        
        .header-subtitle {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .header-instruction {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .form-section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
        }
        
        .service-duration-group {
            display: flex;
            gap: 10px;
        }
        
        .service-duration-group .input-group {
            flex: 1;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .checkbox-group input {
            width: auto;
            margin-left: 10px;
        }
        
        .checkbox-group.disabled {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .notice-info {
            background-color: #e8f4fd;
            padding: 10px;
            border-radius: 4px;
            margin-top: 5px;
            border-right: 4px solid #2c5aa0;
            display: none;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 18px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
            margin-bottom: 10px;
        }
        
        button:hover {
            background-color: #1e3d6f;
        }
        
        .reset-btn {
            background-color: #6c757d;
        }
        
        .reset-btn:hover {
            background-color: #5a6268;
        }
        
        .result-section {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-top: 20px;
            display: none;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 18px;
            color: var(--primary-color);
        }

        .explanation {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border-right: 4px solid var(--primary-color);
        }

        .explanation h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .explanation ul {
            padding-right: 20px;
        }

        .explanation li {
            margin-bottom: 5px;
        }

        .contract-details {
            display: none;
            background-color: #e8f4fd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border-right: 4px solid #2c5aa0;
        }

        .social-security-details {
            display: none;
            background-color: #e8f4fd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border-right: 4px solid #2c5aa0;
        }

        .annual-leave-details {
            background-color: #e8f4fd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border-right: 4px solid #2c5aa0;
        }

        .annual-leave-result {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border-right: 4px solid #2c5aa0;
        }

        .annual-leave-result h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .annual-leave-result .result-item {
            padding: 5px 0;
            font-size: 14px;
        }

        .annual-leave-result .result-item:last-child {
            font-weight: bold;
            font-size: 16px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
        }
        
        .copyright {
            font-size: 12px;
            margin-top: 10px;
            opacity: 0.8;
        }
        
        .law-reference {
            font-size: 14px;
            margin-top: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .action-buttons button {
            flex: 1;
            font-size: 16px;
        }
        
        .print-btn {
            background-color: #28a745;
        }
        
        .print-btn:hover {
            background-color: #218838;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .form-section {
                padding: 15px;
            }
            
            .creator-info {
                position: static;
                transform: none;
                margin-bottom: 10px;
                text-align: center;
            }
            
            .service-duration-group {
                flex-direction: column;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="creator-info">أنشئت بواسطة: المحامي محمد الشوحه</div>
        
        <header>
            <h1>حاسبة الحقوق العمالية</h1>
            <p class="header-subtitle">بناءً على قانون العمل الأردني رقم 8 لسنة 1996 وتعديلاته</p>
            <p class="header-instruction">أدخل معلوماتك لحساب مستحقاتك</p>
        </header>
        
        <form id="rightsCalculator">
            <div class="form-section">
                <h2>معلومات الأجر الأساسي</h2>
                
                <div class="input-group">
                    <label for="wageType">نوع الأجر</label>
                    <select id="wageType" tabindex="1">
                        <option value="daily">أجر يومي</option>
                        <option value="monthly">أجر شهري</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="lastWage">الراتب الأساسي الأخير (دينار)</label>
                    <input type="number" id="lastWage" min="0" step="0.01" required tabindex="2">
                </div>
            </div>
            
            <div class="form-section">
                <h2>الرواتب المستحقة</h2>
                
                <div class="input-group">
                    <label for="contractType">نوع العقد</label>
                    <select id="contractType" tabindex="3">
                        <option value="indefinite">عقد غير محدد المدة</option>
                        <option value="definite">عقد محدد المدة</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="unpaidMonths">عدد أشهر الرواتب المستحقة</label>
                    <input type="number" id="unpaidMonths" min="0" step="1" value="0" tabindex="4">
                </div>

                <div class="input-group">
                    <label for="unpaidDays">عدد الأيام مستحقة الأجر التي لم يتم الحصول عليها</label>
                    <input type="number" id="unpaidDays" min="0" step="1" value="0" tabindex="5">
                </div>

                <div class="input-group">
                    <label for="vacationDays">عدد أيام الإجازات مستحقة الأجر التي لم يتم الحصول عليها</label>
                    <input type="number" id="vacationDays" min="0" step="1" value="0" tabindex="6">
                </div>
                
                <div class="input-group">
                    <label>مدة الخدمة</label>
                    <div class="service-duration-group">
                        <div class="input-group">
                            <label for="serviceYears">السنوات</label>
                            <input type="number" id="serviceYears" min="0" step="1" value="0" tabindex="7">
                        </div>
                        <div class="input-group">
                            <label for="serviceMonths">الأشهر</label>
                            <input type="number" id="serviceMonths" min="0" max="11" step="1" value="0" tabindex="8">
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="startDate">تاريخ بداية العمل</label>
                    <input type="date" id="startDate" required tabindex="9">
                </div>
                
                <div class="input-group">
                    <label for="endDate">تاريخ إنهاء العمل</label>
                    <input type="date" id="endDate" required tabindex="10">
                </div>
                
                <div class="checkbox-group" id="noticeMonthGroup">
                    <input type="checkbox" id="noticeMonth" tabindex="11">
                    <label for="noticeMonth">يستحق بدل شهر الإشعار</label>
                </div>

                <div class="notice-info" id="noticeInfo">
                    بدل شهر الإشعار يساوي راتب شهر كامل
                </div>

                <div class="input-group">
                    <label for="socialSecurity">هل كان العامل مشتركاً بالضمان الاجتماعي؟</label>
                    <select id="socialSecurity" tabindex="12">
                        <option value="yes">نعم - مشترك بالضمان الاجتماعي</option>
                        <option value="no">لا - غير مشترك بالضمان الاجتماعي</option>
                    </select>
                </div>

                <div class="social-security-details" id="socialSecurityDetails">
                    <div class="input-group">
                        <label>ملاحظة: حسب المادة (73) من قانون العمل الأردني، يحق للعامل غير المشترك بالضمان الاجتماعي الحصول على تعويض نهاية الخدمة بواقع أجر شهر عن كل سنة عمل</label>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="terminationType">سبب إنهاء الخدمة</label>
                    <select id="terminationType" tabindex="13">
                        <option value="mutual">إنهاء الخدمة برضا الطرفين</option>
                        <option value="indefinite">فصل تعسفي (عقد غير محدد المدة)</option>
                        <option value="definite">فصل تعسفي (عقد محدد المدة)</option>
                    </select>
                </div>

                <div class="checkbox-group" id="arbitraryDismissalGroup" style="display: none;">
                    <input type="checkbox" id="arbitraryDismissal" tabindex="14">
                    <label for="arbitraryDismissal">يستحق بدل فصل تعسفي (نصف شهر عن كل سنة خدمة بما لا يقل عن شهرين)</label>
                </div>

                <div class="contract-details" id="contractDetails">
                    <div class="input-group">
                        <label for="contractDuration">مدة العقد (بالأشهر)</label>
                        <input type="number" id="contractDuration" min="1" step="1" value="12" tabindex="15">
                    </div>
                    
                    <div class="input-group">
                        <label for="workedMonths">عدد الأشهر التي عملتها في العقد</label>
                        <input type="number" id="workedMonths" min="0" step="1" value="0" tabindex="16">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>العمل الإضافي</h2>
                
                <div class="input-group">
                    <label for="overtimeHours">عدد ساعات العمل الإضافي في اليوم</label>
                    <input type="number" id="overtimeHours" min="0" step="0.5" value="0" tabindex="17">
                </div>
                
                <div class="input-group">
                    <label for="overtimeDays">عدد أيام العمل الإضافي</label>
                    <input type="number" id="overtimeDays" min="0" step="1" value="0" tabindex="18">
                </div>
            </div>
            
            <div class="form-section">
                <h2>العمل في العطل والأعياد وأيام الجمعة</h2>
                
                <div class="input-group">
                    <label for="holidayDays">عدد أيام العطل الرسمية والدينية التي عملت بها</label>
                    <input type="number" id="holidayDays" min="0" step="1" value="0" tabindex="19">
                </div>
                
                <div class="input-group">
                    <label for="fridayDays">عدد أيام الجمعة التي عملت بها</label>
                    <input type="number" id="fridayDays" min="0" step="1" value="0" tabindex="20">
                </div>
            </div>
            
            <button type="submit" tabindex="21">احسب المستحقات</button>
            <button type="button" class="reset-btn" id="resetBtn" tabindex="22">تفريغ الحقول</button>
        </form>
        
        <div class="result-section" id="resultSection">
            <h2>نتائج حساب المستحقات</h2>
            <div id="resultContent">
                <!-- سيتم ملء النتائج هنا بواسطة JavaScript -->
            </div>
            
            <div class="annual-leave-result" id="annualLeaveResult">
                <!-- سيتم ملء نتائج الإجازات السنوية هنا بواسطة JavaScript -->
            </div>
            
            <div class="explanation" id="explanationSection">
                <!-- سيتم ملء الشرح هنا بواسطة JavaScript -->
            </div>
            
            <div class="action-buttons">
                <button type="button" class="print-btn" id="printBtn">طباعة النتائج</button>
            </div>
        </div>

        <div class="footer">
            <p>تم إنشاء هذه الصفحة بواسطة المحامي محمد الشوحه</p>
            <p class="law-reference">تم إنشاء هذه الحاسبة وفقاً لقانون العمل الأردني رقم 8 لسنة 1996 وتعديلاته</p>
            <p class="copyright">جميع الحقوق محفوظة © 2023 - هذه الصفحة محمية بموجب قوانين حقوق النشر والملكية الفكرية</p>
        </div>
    </div>

    <script>
        document.getElementById('rightsCalculator').addEventListener('submit', function(e) {
            e.preventDefault();
            calculateRights();
        });

        // إضافة حدث لزر تفريغ الحقول
        document.getElementById('resetBtn').addEventListener('click', function() {
            document.getElementById('rightsCalculator').reset();
            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('contractDetails').style.display = 'none';
            document.getElementById('socialSecurityDetails').style.display = 'none';
            document.getElementById('noticeInfo').style.display = 'none';
            document.getElementById('noticeMonthGroup').classList.remove('disabled');
            document.getElementById('noticeMonth').disabled = false;
            document.getElementById('arbitraryDismissalGroup').style.display = 'none';
            document.getElementById('arbitraryDismissal').checked = false;
            
            // إعادة تعيين التواريخ الافتراضية
            const today = new Date();
            const threeYearsAgo = new Date();
            threeYearsAgo.setFullYear(today.getFullYear() - 3);
            
            document.getElementById('startDate').valueAsDate = threeYearsAgo;
            document.getElementById('endDate').valueAsDate = today;
        });

        // التحكم في إظهار/إخفاء تفاصيل العقد المحدد المدة
        document.getElementById('contractType').addEventListener('change', function() {
            const contractDetails = document.getElementById('contractDetails');
            const noticeMonthGroup = document.getElementById('noticeMonthGroup');
            const noticeMonth = document.getElementById('noticeMonth');
            const arbitraryDismissalGroup = document.getElementById('arbitraryDismissalGroup');
            
            if (this.value === 'definite') {
                contractDetails.style.display = 'block';
                noticeMonthGroup.classList.add('disabled');
                noticeMonth.checked = false;
                noticeMonth.disabled = true;
                document.getElementById('terminationType').value = 'definite';
                arbitraryDismissalGroup.style.display = 'none';
                document.getElementById('arbitraryDismissal').checked = false;
            } else {
                contractDetails.style.display = 'none';
                noticeMonthGroup.classList.remove('disabled');
                noticeMonth.disabled = false;
                document.getElementById('terminationType').value = 'indefinite';
                updateArbitraryDismissalGroup();
            }
        });

        // التحكم في إظهار/إخفاء خيار بدل الفصل التعسفي
        document.getElementById('terminationType').addEventListener('change', function() {
            updateArbitraryDismissalGroup();
        });

        function updateArbitraryDismissalGroup() {
            const arbitraryDismissalGroup = document.getElementById('arbitraryDismissalGroup');
            const contractType = document.getElementById('contractType').value;
            const terminationType = document.getElementById('terminationType').value;
            
            if (contractType === 'indefinite' && terminationType === 'indefinite') {
                arbitraryDismissalGroup.style.display = 'flex';
            } else {
                arbitraryDismissalGroup.style.display = 'none';
                document.getElementById('arbitraryDismissal').checked = false;
            }
        }

        // إظهار/إخفاء تفاصيل الضمان الاجتماعي
        document.getElementById('socialSecurity').addEventListener('change', function() {
            const socialSecurityDetails = document.getElementById('socialSecurityDetails');
            if (this.value === 'no') {
                socialSecurityDetails.style.display = 'block';
            } else {
                socialSecurityDetails.style.display = 'none';
            }
        });

        // إظهار/إخفاء معلومات بدل شهر الإشعار
        document.getElementById('noticeMonth').addEventListener('change', function() {
            const noticeInfo = document.getElementById('noticeInfo');
            if (this.checked) {
                noticeInfo.style.display = 'block';
            } else {
                noticeInfo.style.display = 'none';
            }
        });
        
        // زر الطباعة
        document.getElementById('printBtn').addEventListener('click', function() {
            window.print();
        });
        
        // إضافة وظيفة للانتقال بين الحقول عند الضغط على Enter
        document.querySelectorAll('input, select').forEach((field, index, fields) => {
            field.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const nextIndex = index + 1;
                    if (nextIndex < fields.length) {
                        fields[nextIndex].focus();
                    }
                }
            });
        });
        
        function calculateRights() {
            // الحصول على القيم من النموذج
            const wageType = document.getElementById('wageType').value;
            const lastWage = parseFloat(document.getElementById('lastWage').value);
            const contractType = document.getElementById('contractType').value;
            const unpaidMonths = parseInt(document.getElementById('unpaidMonths').value);
            const unpaidDays = parseInt(document.getElementById('unpaidDays').value);
            const vacationDays = parseInt(document.getElementById('vacationDays').value);
            const serviceYears = parseInt(document.getElementById('serviceYears').value);
            const serviceMonths = parseInt(document.getElementById('serviceMonths').value);
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            const noticeMonth = document.getElementById('noticeMonth').checked;
            const terminationType = document.getElementById('terminationType').value;
            const socialSecurity = document.getElementById('socialSecurity').value;
            const overtimeHours = parseFloat(document.getElementById('overtimeHours').value);
            const overtimeDays = parseInt(document.getElementById('overtimeDays').value);
            const holidayDays = parseInt(document.getElementById('holidayDays').value);
            const fridayDays = parseInt(document.getElementById('fridayDays').value);
            const contractDuration = parseInt(document.getElementById('contractDuration').value);
            const workedMonths = parseInt(document.getElementById('workedMonths').value);
            const arbitraryDismissal = document.getElementById('arbitraryDismissal').checked;
            
            // حساب إجمالي مدة الخدمة بالأشهر
            const totalServiceMonths = (serviceYears * 12) + serviceMonths;
            
            // حساب الأجر اليومي والشهري (باستخدام 30 يومًا)
            const dailyWage = wageType === 'daily' ? lastWage : lastWage / 30;
            const monthlyWage = wageType === 'monthly' ? lastWage : lastWage * 30;
            
            // حساب الأجر الساعي (8 ساعات عمل يومياً)
            const hourlyWage = dailyWage / 8;
            
            // حساب الرواتب المستحقة (أشهر + أيام)
            const unpaidSalaries = (unpaidMonths * monthlyWage) + (unpaidDays * dailyWage);
            
            // حساب بدل الإجازات المستحقة
            const vacationPay = vacationDays * dailyWage;
            
            // حساب بدل نهاية الخدمة
            let endOfServiceCompensation = 0;
            let explanation = "";
            
            // حساب بدل الفصل التعسفي إذا تم اختياره
            let arbitraryDismissalCompensation = 0;
            let arbitraryDismissalExplanation = "";
            
            if (arbitraryDismissal && contractType === 'indefinite' && terminationType === 'indefinite') {
                // حساب بدل الفصل التعسفي: نصف شهر عن كل سنة خدمة بما لا يقل عن شهرين
                const monthlyCompensation = monthlyWage / 2;
                arbitraryDismissalCompensation = (monthlyCompensation * serviceYears) + (monthlyCompensation * serviceMonths / 12);
                
                // الحد الأدنى شهرين
                const minimumCompensation = monthlyWage * 2;
                if (arbitraryDismissalCompensation < minimumCompensation) {
                    arbitraryDismissalCompensation = minimumCompensation;
                    arbitraryDismissalExplanation = `بدل الفصل التعسفي: (${monthlyWage.toFixed(2)} ÷ 2) × ${serviceYears} سنة + (${monthlyWage.toFixed(2)} ÷ 2) × ${serviceMonths} شهر ÷ 12 = ${(monthlyCompensation * serviceYears + monthlyCompensation * serviceMonths / 12).toFixed(2)} دينار، ولكن بما لا يقل عن أجر شهرين (${minimumCompensation.toFixed(2)} دينار)`;
                } else {
                    arbitraryDismissalExplanation = `بدل الفصل التعسفي: (${monthlyWage.toFixed(2)} ÷ 2) × ${serviceYears} سنة + (${monthlyWage.toFixed(2)} ÷ 2) × ${serviceMonths} شهر ÷ 12 = ${arbitraryDismissalCompensation.toFixed(2)} دينار`;
                }
            }
            
            if (socialSecurity === 'no') {
                // غير مشترك بالضمان الاجتماعي - أجر شهر عن كل سنة
                // حساب المكافأة بناءً على إجمالي مدة الخدمة بالأشهر
                const monthlyCompensation = monthlyWage / 12;
                endOfServiceCompensation = monthlyCompensation * totalServiceMonths;
                explanation = `تعويض نهاية الخدمة (غير مشترك بالضمان): (${monthlyWage.toFixed(2)} ÷ 12) × ${totalServiceMonths} شهر = ${endOfServiceCompensation.toFixed(2)} دينار`;
                
            } else {
                // مشترك بالضمان الاجتماعي - حسب نوع إنهاء الخدمة
                if (terminationType === 'mutual') {
                    // إنهاء برضا الطرفين - نصف شهر عن كل سنة
                    const monthlyCompensation = monthlyWage / 12;
                    endOfServiceCompensation = monthlyCompensation * totalServiceMonths / 2;
                    explanation = `تعويض نهاية الخدمة (رضا الطرفين): (${monthlyWage.toFixed(2)} ÷ 12) × ${totalServiceMonths} شهر ÷ 2 = ${endOfServiceCompensation.toFixed(2)} دينار`;
                    
                } else if (terminationType === 'indefinite') {
                    // فصل تعسفي لعقد غير محدد المدة
                    // حساب بدل الفصل التعسفي: نصف شهر عن كل سنة خدمة
                    const monthlyCompensation = monthlyWage / 12;
                    endOfServiceCompensation = monthlyCompensation * totalServiceMonths / 2;
                    
                    // الحد الأدنى شهرين
                    const minimumCompensation = monthlyWage * 2;
                    if (endOfServiceCompensation < minimumCompensation) {
                        endOfServiceCompensation = minimumCompensation;
                        explanation = `بدل الفصل التعسفي: (${monthlyWage.toFixed(2)} ÷ 12) × ${totalServiceMonths} شهر ÷ 2 = ${(monthlyCompensation * totalServiceMonths / 2).toFixed(2)} دينار، ولكن بما لا يقل عن أجر شهرين (${minimumCompensation.toFixed(2)} دينار)`;
                    } else {
                        explanation = `بدل الفصل التعسفي: (${monthlyWage.toFixed(2)} ÷ 12) × ${totalServiceMonths} شهر ÷ 2 = ${endOfServiceCompensation.toFixed(2)} دينار`;
                    }
                    
                } else if (terminationType === 'definite') {
                    // فصل تعسفي لعقد محدد المدة - الأجر عن الأشهر المتبقية
                    const remainingMonths = contractDuration - workedMonths;
                    endOfServiceCompensation = monthlyWage * remainingMonths;
                    explanation = `بدل الفصل التعسفي: أجر ${remainingMonths} شهر المتبقية من العقد = ${endOfServiceCompensation.toFixed(2)} دينار`;
                }
            }
            
            // حساب بدل شهر الإشعار (راتب شهر كامل)
            let noticeAllowance = 0;
            if (contractType === 'indefinite' && noticeMonth) {
                noticeAllowance = monthlyWage;
            } else if (contractType === 'definite' && terminationType === 'definite') {
                // لا يستحق بدل شهر الإشعار في حالة الفصل التعسفي للعقد محدد المدة
                noticeAllowance = 0;
            } else if (noticeMonth) {
                noticeAllowance = monthlyWage;
            }
            
            // حساب العمل الإضافي (125% من الأجر الساعي)
            let overtimePay = 0;
            if (overtimeHours > 0 && overtimeDays > 0) {
                // 125% من الأجر الساعي لجميع ساعات العمل الإضافي
                const totalOvertimeHours = overtimeHours * overtimeDays;
                overtimePay = totalOvertimeHours * hourlyWage * 1.25;
            }
            
            // حساب العمل في العطل والأعياد
            // معدل العمل في العطل: 150%
            const holidayPay = holidayDays * dailyWage * 1.5;
            
            // حساب العمل في أيام الجمعة
            // معدل العمل في الجمعة: 150%
            const fridayPay = fridayDays * dailyWage * 1.5;
            
            // حساب الإجازات السنوية المستحقة
            const annualLeaveResult = calculateAnnualLeave(serviceYears, serviceMonths, dailyWage);
            
            // إجمالي المستحقات
            const totalRights = unpaidSalaries + vacationPay + endOfServiceCompensation + noticeAllowance + overtimePay + holidayPay + fridayPay + arbitraryDismissalCompensation + annualLeaveResult.totalLeavePay;
            
            // عرض النتائج
            displayResults({
                unpaidSalaries,
                vacationPay,
                endOfServiceCompensation,
                noticeAllowance,
                overtimePay,
                holidayPay,
                fridayPay,
                arbitraryDismissalCompensation,
                totalRights,
                explanation,
                arbitraryDismissalExplanation,
                terminationType,
                socialSecurity,
                contractType,
                contractDuration,
                workedMonths,
                unpaidDays,
                vacationDays,
                overtimeDays,
                overtimeHours,
                hourlyWage,
                noticeMonth,
                totalServiceMonths,
                monthlyWage,
                arbitraryDismissal,
                annualLeaveResult
            });
        }
        
        function calculateAnnualLeave(serviceYears, serviceMonths, dailyWage) {
            let totalLeaveDays = 0;
            let totalLeavePay = 0;
            let explanation = "";
            let note = "";
            
            // حساب إجمالي مدة الخدمة بالأشهر
            const totalServiceMonths = (serviceYears * 12) + serviceMonths;
            
            // إذا كانت مدة الخدمة أقل من 5 سنوات (60 شهر)
            if (totalServiceMonths < 60) {
                // يستحق 14 يوم إجازة سنوية عن كل سنة
                // يتم احتساب آخر سنتين فقط
                const lastTwoYearsMonths = Math.min(totalServiceMonths, 24);
                totalLeaveDays = (14 / 12) * lastTwoYearsMonths;
                totalLeavePay = totalLeaveDays * dailyWage;
                
                explanation = `عدد أيام الإجازة السنوية المستحقة: (14 يوم ÷ 12 شهر) × ${lastTwoYearsMonths} شهر (آخر سنتين) = ${totalLeaveDays.toFixed(2)} يوم`;
                note = "ملاحظة: يتم احتساب الإجازات السنوية عن آخر سنتين فقط من مدة الخدمة";
            } 
            // إذا كانت مدة الخدمة 5 سنوات أو أكثر
            else {
                // يستحق 21 يوم إجازة سنوية عن كل سنة
                // يتم احتساب آخر سنتين فقط
                const lastTwoYearsMonths = Math.min(totalServiceMonths, 24);
                totalLeaveDays = (21 / 12) * lastTwoYearsMonths;
                totalLeavePay = totalLeaveDays * dailyWage;
                
                explanation = `عدد أيام الإجازة السنوية المستحقة: (21 يوم ÷ 12 شهر) × ${lastTwoYearsMonths} شهر (آخر سنتين) = ${totalLeaveDays.toFixed(2)} يوم`;
                note = "ملاحظة: يتم احتساب الإجازات السنوية عن آخر سنتين فقط من مدة الخدمة";
            }
            
            return {
                totalLeaveDays: totalLeaveDays,
                totalLeavePay: totalLeavePay,
                explanation: explanation,
                note: note
            };
        }
        
        function displayResults(results) {
            const resultContent = document.getElementById('resultContent');
            const annualLeaveResult = document.getElementById('annualLeaveResult');
            const explanationSection = document.getElementById('explanationSection');
            resultContent.innerHTML = '';
            
            const items = [
                { label: 'الرواتب المستحقة', value: results.unpaidSalaries.toFixed(2) },
                { label: 'بدل الإجازات المستحقة', value: results.vacationPay.toFixed(2) },
                { label: results.socialSecurity === 'no' ? 'تعويض نهاية الخدمة (غير مشترك بالضمان)' : 'بدل نهاية الخدمة', value: results.endOfServiceCompensation.toFixed(2) },
                { label: 'بدل شهر الإشعار', value: results.noticeAllowance.toFixed(2) }
            ];
            
            // إضافة بدل الفصل التعسفي إذا كان موجوداً
            if (results.arbitraryDismissalCompensation > 0) {
                items.push({ label: 'بدل الفصل التعسفي', value: results.arbitraryDismissalCompensation.toFixed(2) });
            }
            
            items.push(
                { label: 'أجر العمل الإضافي', value: results.overtimePay.toFixed(2) },
                { label: 'أجر العطل الرسمية', value: results.holidayPay.toFixed(2) },
                { label: 'أجر أيام الجمعة', value: results.fridayPay.toFixed(2) },
                { label: 'إجمالي المستحقات', value: results.totalRights.toFixed(2) }
            );
            
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.innerHTML = `
                    <span>${item.label}</span>
                    <span>${item.value} دينار</span>
                `;
                resultContent.appendChild(div);
            });
            
            // عرض نتائج الإجازات السنوية
            annualLeaveResult.innerHTML = `
                <h4>الإجازات السنوية المستحقة</h4>
                <div class="result-item">
                    <span>عدد أيام الإجازة السنوية المستحقة</span>
                    <span>${results.annualLeaveResult.totalLeaveDays.toFixed(2)} يوم</span>
                </div>
                <div class="result-item">
                    <span>أجر الإجازات السنوية المستحقة</span>
                    <span>${results.annualLeaveResult.totalLeavePay.toFixed(2)} دينار</span>
                </div>
                <div class="annual-leave-details">
                    <p>${results.annualLeaveResult.explanation}</p>
                    <p><strong>${results.annualLeaveResult.note}</strong></p>
                </div>
            `;
            
            // عرض شرح مفصل للحسابات
            let contractDetails = "";
            if (results.contractType === 'definite') {
                const remainingMonths = results.contractDuration - results.workedMonths;
                contractDetails = `
                    <li>مدة العقد: ${results.contractDuration} شهر</li>
                    <li>الأشهر التي عملتها: ${results.workedMonths} شهر</li>
                    <li>الأشهر المتبقية: ${remainingMonths} شهر</li>
                `;
            }

            let unpaidDaysText = "";
            if (results.unpaidDays > 0) {
                unpaidDaysText = `<li>الأيام الإضافية المستحقة: ${results.unpaidDays} يوم</li>`;
            }

            let vacationDaysText = "";
            if (results.vacationDays > 0) {
                vacationDaysText = `<li>أيام الإجازات المستحقة: ${results.vacationDays} يوم</li>`;
            }

            let overtimeText = "";
            if (results.overtimeHours > 0 && results.overtimeDays > 0) {
                const totalOvertimeHours = results.overtimeHours * results.overtimeDays;
                overtimeText = `<li>العمل الإضافي: ${totalOvertimeHours} ساعة × ${results.hourlyWage.toFixed(2)} دينار (الأجر الساعي) × 125%</li>`;
            }
            
            let noticeText = "";
            if (results.contractType === 'definite' && results.terminationType === 'definite') {
                noticeText = `<li>بدل شهر الإشعار: غير مستحق في حالة الفصل التعسفي للعقد محدد المدة</li>`;
            } else {
                noticeText = `<li>بدل شهر الإشعار: ${results.noticeMonth ? 'راتب شهر كامل' : 'غير مستحق'}</li>`;
            }
            
            let arbitraryDismissalText = "";
            if (results.arbitraryDismissal) {
                arbitraryDismissalText = `<li>${results.arbitraryDismissalExplanation}</li>`;
            }
            
            explanationSection.innerHTML = `
                <h3>تفاصيل الحسابات:</h3>
                <ul>
                    <li>${results.explanation}</li>
                    ${arbitraryDismissalText}
                    <li>إجمالي مدة الخدمة: ${results.totalServiceMonths} شهر (${document.getElementById('serviceYears').value} سنة و ${document.getElementById('serviceMonths').value} شهر)</li>
                    ${contractDetails}
                    <li>الرواتب المستحقة: ${document.getElementById('unpaidMonths').value} أشهر × الراتب الشهري</li>
                    ${unpaidDaysText}
                    ${vacationDaysText}
                    ${noticeText}
                    ${overtimeText}
                    <li>العمل في العطل: ${document.getElementById('holidayDays').value} يوم × 150% من الأجر اليومي</li>
                    <li>العمل في الجمع: ${document.getElementById('fridayDays').value} يوم × 150% من الأجر اليومي</li>
                </ul>
            `;
            
            document.getElementById('resultSection').style.display = 'block';
        }
        
        // تعيين التواريخ الافتراضية
        window.onload = function() {
            const today = new Date();
            const threeYearsAgo = new Date();
            threeYearsAgo.setFullYear(today.getFullYear() - 3);
            
            document.getElementById('startDate').valueAsDate = threeYearsAgo;
            document.getElementById('endDate').valueAsDate = today;
        };
    </script>
</body>
</html>
